#!/bin/bash
gateway_path="$(dirname "$0")/gateway"
tmp=`mktemp`

echo "# Auto generated by bird-conf-gateway" >> "$tmp"
if ipv4_gw=`"$gateway_path" -4`; then
  echo "define GATEWAYv4 = $ipv4_gw;" >> "$tmp"
fi
if ipv6_gw=`"$gateway_path" -6`; then
  echo "define GATEWAYv6 = $ipv6_gw;" >> "$tmp"
fi

set -e
chmod 0644 "$tmp"
mv "$tmp" "/etc/bird/preload/gateway.conf"
/usr/sbin/birdc c
